# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è –ù–µ–π—Ä–æ–º–∞–≥–∏–∏

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1Ô∏è‚É£ **–ö—É–ø–∏—Ç—å –¥–æ–º–µ–Ω**

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã:
- **REG.RU** (—Ä—É—Å—Å–∫–∏–π, —É–¥–æ–±–Ω—ã–π)
- **Timeweb** (–¥–µ—à—ë–≤—ã–π)
- **Cloudflare** (—Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º CDN)
- **Namecheap** (–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π)

**–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~300-800‚ÇΩ/–≥–æ–¥ –∑–∞ `.ru` –¥–æ–º–µ–Ω

---

### 2Ô∏è‚É£ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –∑–∞–ø–∏—Å–∏**

–í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–º –¥–æ–±–∞–≤—å **2 A-–∑–∞–ø–∏—Å–∏**:

| –¢–∏–ø | –ò–º—è | –ó–Ω–∞—á–µ–Ω–∏–µ | TTL |
|-----|-----|----------|-----|
| A | @ | `138.124.15.60` | 3600 |
| A | www | `138.124.15.60` | 3600 |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: DNS –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç **5-30 –º–∏–Ω—É—Ç**, –∏–Ω–æ–≥–¥–∞ –¥–æ 2 —á–∞—Å–æ–≤.

---

### 3Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–æ–º–µ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç**

```bash
# –ù–∞ —Å–≤–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
ping –≤–∞—à-–¥–æ–º–µ–Ω.ru
ping www.–≤–∞—à-–¥–æ–º–µ–Ω.ru

# –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å 138.124.15.60
```

–ò–ª–∏ –æ—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://–≤–∞—à-–¥–æ–º–µ–Ω.ru` (–ø–æ–∫–∞ –±–µ–∑ HTTPS)

---

### 4Ô∏è‚É£ **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É SSL**

–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –∑–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:

```bash
ssh root@138.124.15.60

cd /opt/neuromagic

# –°–¥–µ–ª–∞–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x setup-ssl.sh

# –ó–∞–ø—É—Å—Ç–∏
./setup-ssl.sh
```

–°–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç:
```
–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, neuro-magic.ru): 
```

–í–≤–µ–¥–∏ —Å–≤–æ–π –¥–æ–º–µ–Ω (–±–µ–∑ `www` –∏ –±–µ–∑ `http://`)

---

## ü§ñ **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

1. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Certbot
2. ‚úÖ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç nginx –≤—Ä–µ–º–µ–Ω–Ω–æ
3. ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt (–±–µ—Å–ø–ª–∞—Ç–Ω–æ!)
4. ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç
5. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç nginx –∫–æ–Ω—Ñ–∏–≥ —Å —Ç–≤–æ–∏–º –¥–æ–º–µ–Ω–æ–º
6. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç nginx
7. ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

---

## ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã HTTPS:**

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞:

1. –û—Ç–∫—Ä–æ–π: `https://–≤–∞—à-–¥–æ–º–µ–Ω.ru` 
2. –í –±—Ä–∞—É–∑–µ—Ä–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **üîí –∑–µ–ª—ë–Ω—ã–π –∑–∞–º–æ—á–µ–∫**
3. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—ã–¥–∞–Ω: **Let's Encrypt**
4. –†–µ–¥–∏—Ä–µ–∫—Ç: `http://` ‚Üí `https://` —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üîß **–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**

### –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏ nginx
docker-compose stop nginx

# 2. –ü–æ–ª—É—á–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—Ä—É—á–Ω—É—é
certbot certonly --standalone -d –≤–∞—à-–¥–æ–º–µ–Ω.ru -d www.–≤–∞—à-–¥–æ–º–µ–Ω.ru

# 3. –°–∫–æ–ø–∏—Ä—É–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
mkdir -p nginx/ssl
cp /etc/letsencrypt/live/–≤–∞—à-–¥–æ–º–µ–Ω.ru/fullchain.pem nginx/ssl/
cp /etc/letsencrypt/live/–≤–∞—à-–¥–æ–º–µ–Ω.ru/privkey.pem nginx/ssl/

# 4. –û–±–Ω–æ–≤–∏ –∫–æ–Ω—Ñ–∏–≥
nano nginx/nginx.conf
# –ó–∞–º–µ–Ω–∏ YOUR_DOMAIN –Ω–∞ —Å–≤–æ–π –¥–æ–º–µ–Ω

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏
docker-compose --profile production up -d nginx
```

---

## üîÑ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:**

–°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ cron.

–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt –¥–µ–π—Å—Ç–≤—É—é—Ç **90 –¥–Ω–µ–π**, –Ω–æ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

```bash
# –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
certbot renew --dry-run

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Congratulations, all simulated renewals succeeded"
```

---

## üêõ **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:**

### –û—à–∏–±–∫–∞: `Challenge failed`

**–ü—Ä–∏—á–∏–Ω–∞**: DNS –µ—â—ë –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è –∏–ª–∏ –ø–æ—Ä—Ç 80 –∑–∞–∫—Ä—ã—Ç.

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –¥–æ–º–µ–Ω —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è
nslookup –≤–∞—à-–¥–æ–º–µ–Ω.ru

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç
curl http://–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

### –û—à–∏–±–∫–∞: `nginx: configuration file test failed`

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º.

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞ –º–µ—Å—Ç–µ
ls -la /opt/neuromagic/nginx/ssl/

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# fullchain.pem
# privkey.pem
```

### –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ"

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω –≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ.

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å –¥–ª—è –∫–∞–∫–æ–≥–æ –¥–æ–º–µ–Ω–∞ –≤—ã–¥–∞–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
openssl x509 -in nginx/ssl/fullchain.pem -noout -text | grep "DNS:"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# DNS:–≤–∞—à-–¥–æ–º–µ–Ω.ru, DNS:www.–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

---

## üìä **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å —Å–≤–æ–π SSL:

**SSL Labs Test**: https://www.ssllabs.com/ssltest/analyze.html?d=–≤–∞—à-–¥–æ–º–µ–Ω.ru

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ **A** –∏–ª–∏ **A+** üéâ

---

## üéØ **–ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç:**

- [ ] –î–æ–º–µ–Ω –∫—É–ø–ª–µ–Ω
- [ ] DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω (A-–∑–∞–ø–∏—Å–∏ –¥–ª—è @ –∏ www)
- [ ] DNS –æ–±–Ω–æ–≤–∏–ª—Å—è (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ ping)
- [ ] –°–∫—Ä–∏–ø—Ç `setup-ssl.sh` –∑–∞–ø—É—â–µ–Ω
- [ ] `https://–≤–∞—à-–¥–æ–º–µ–Ω.ru` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å üîí
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç —Å HTTP –Ω–∞ HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] SSL —Ä–µ–π—Ç–∏–Ω–≥ A/A+ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ ssllabs.com)
- [ ] –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (`certbot renew --dry-run`)

---

## üí° **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**

### Cloudflare (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è)

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å Cloudflare:

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –Ω–∞ cloudflare.com
2. –î–æ–±–∞–≤—å —Å–≤–æ–π –¥–æ–º–µ–Ω
3. –°–º–µ–Ω–∏ NS —Å–µ—Ä–≤–µ—Ä—ã –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ –Ω–∞ Cloudflare
4. –í–∫–ª—é—á–∏ **Proxy** (–æ—Ä–∞–Ω–∂–µ–≤–æ–µ –æ–±–ª–∞–∫–æ)

**–ë–æ–Ω—É—Å—ã:**
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π CDN (—É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS
- ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π SSL –æ—Ç Cloudflare
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π

---

**üéâ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É —Ç–µ–±—è –±—É–¥–µ—Ç:**
- ‚úÖ HTTPS —Å A+ —Ä–µ–π—Ç–∏–Ω–≥–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç HTTP ‚Üí HTTPS
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ HTTP/2 –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É! üöÄ**

